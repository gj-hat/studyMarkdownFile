# Lua语言



## 01_基础语法



### 1.1 注释

1. 单行注释`--`

2. 多行注释

   ``` lua
   --[[
    多行注释
    多行注释
    --]]
   ```



### 1.2 关键字

以下列出了 Lua 的保留关键词。保留关键字不能作为常量或变量或其他用户自定义标示符：

| and      | break | do    | else   |
| -------- | ----- | ----- | ------ |
| elseif   | end   | false | for    |
| function | if    | in    | local  |
| nil      | not   | or    | repeat |
| return   | then  | true  | until  |
| while    | goto  |       |        |



### 1.3 数据类型

Lua 是动态类型语言，变量不要类型定义,只需要为变量赋值(类似于python)。 值可以存储在变量中，作为参数传递或结果返回。

Lua 中有 8 个基本类型分别为：nil、boolean、number、string、userdata、function、thread 和 table。

| 数据类型 | 描述                                                         |
| :------- | :----------------------------------------------------------- |
| nil      | 这个最简单，只有值nil属于该类，表示一个无效值（在条件表达式中相当于false）。 |
| boolean  | 包含两个值：false和true。                                    |
| number   | 表示双精度类型的实浮点数                                     |
| string   | 字符串由一对双引号或单引号来表示                             |
| function | 由 C 或 Lua 编写的函数                                       |
| userdata | 表示任意存储在变量中的C数据结构                              |
| thread   | 表示执行的独立线路，用于执行协同程序                         |
| table    | Lua 中的表（table）其实是一个"关联数组"（associative arrays），数组的索引可以是数字、字符串或表类型。在 Lua 里，table 的创建是通过"构造表达式"来完成，最简单构造表达式是{}，用来创建一个空表。 |

**说明:**

1. type(x) = nil    此时nil是字符串
2. table相当于array+数组       table的索引不一定是数字  也可以是字符串 如果是字符串就类似map
3. function就是方法  和js python一样 参数不需要指定类型
4. thread:在 Lua 里，最主要的线程是协同程序（coroutine）。它跟线程（thread）差不多，拥有自己独立的栈、局部变量和指令指针，可以跟其他协同程序共享全局变量和其他大部分东西。线程跟协程的区别：线程可以同时多个运行，而协程任意时刻只能运行一个，并且处于运行状态的协程只有被挂起（suspend）时才会暂停。
5. userdata(自定义数据类型):  类似于c的结构体



### 1.4 变量

变量分为局部和全局:

``` lua
a = 10    --全局
local b = 5    -- 局部
-------------

function test()
  c = 1    -- 全局
  local d = 2      -- 局部
```

赋值: 类似于python

可以直接赋值  可以交换

``` lua
a, b = 1, 2
a, b = b, a
a, b = 0, 1, 2    -- 2会被忽略
a, b, c = 0, 1       -- c = nil
```



### 1.5 循环控制判断

1. 循环

   | 循环类型       | 描述                                                         |
   | :------------- | :----------------------------------------------------------- |
   | while 循环     | 在条件为 true 时，让程序重复地执行某些语句。执行语句前会先检查条件是否为 true。 |
   | for 循环       | 重复执行指定语句，重复次数可在 for 语句中控制。              |
   | repeat...until | 重复执行循环，直到 指定的条件为真时为止                      |
   | 循环嵌套       | 可以在循环内嵌套一个或多个循环语句（while do ... end;for ... do ... end;repeat ... until;） |

2. 控制

   | 控制语句   | 描述                                             |
   | :--------- | :----------------------------------------------- |
   | break 语句 | 退出当前循环或语句，并开始脚本执行紧接着的语句。 |
   | goto 语句  | 将程序的控制点转移到一个标签处。                 |

3. 判断

   | 语句           | 描述                                                         |
   | :------------- | :----------------------------------------------------------- |
   | if 语句        | **if 语句** 由一个布尔表达式作为条件判断，其后紧跟其他语句组成。 |
   | if...else 语句 | **if 语句** 可以与 **else 语句**搭配使用, 在 if 条件表达式为 false 时执行 else 语句代码。 |
   | if 嵌套语句    | 你可以在**if** 或 **else if**中使用一个或多个 **if** 或 **else if** 语句 。 |



### 1.6 函数

在Lua中，函数是对语句和表达式进行抽象的主要方法。既可以用来处理一些特殊的工作，也可以用来计算一些值。

Lua 提供了许多的内建函数，你可以很方便的在程序中调用它们，如print()函数可以将传入的参数打印在控制台上。

Lua 函数主要有两种用途：

- 1.完成指定的任务，这种情况下函数作为调用语句使用；
- 2.计算并返回值，这种情况下函数作为赋值语句的表达式使用。

**定义:**

``` lua
optional_function_scope function function_name( argument1, argument2, argument3..., argumentn)
    function_body
    return result_params_comma_separated
end
```

**解析:**

- **optional_function_scope:** 该参数是可选的制定函数是全局函数还是局部函数，未设置该参数默认为全局函数，如果你需要设置函数为局部函数需要使用关键字 **local**。
- **function_name:** 指定函数名称。
- **argument1, argument2, argument3..., argumentn:** 函数参数，多个参数以逗号隔开，函数也可以不带参数。
- **function_body:** 函数体，函数中需要执行的代码语句块。
- **result_params_comma_separated:** 函数返回值，Lua语言函数可以返回多个值，每个值以逗号隔开。



**返回值:**

类似python可以多返回值



**参数:**

Lua 函数可以接受可变数目的参数，和 C 语言类似，在函数参数列表中使用三点 **...** 表示函数有可变的参数。

当然也可以定参+不定参

```lua
function add(...)  
local s = 0  
  for i, v in ipairs{...} do   --> {...} 表示一个由所有变长参数构成的数组  
    s = s + v  
  end  
  return s  
end  
print(add(3,4,5,6,7))  --->25
```



**注意:**

通常在遍历变长参数的时候只需要使用 **{…}**，然而变长参数可能会包含一些 **nil**，那么就可以用 **select** 函数来访问变长参数了：**select('#', …)** 或者 **select(n, …)**

- **select('#', …)** 返回可变参数的长度。
- **select(n, …)** 用于返回从起点 **n** 开始到结束位置的所有参数列表。

调用 select 时，必须传入一个固定实参 selector(选择开关) 和一系列变长参数。如果 selector 为数字 n，那么 select 返回参数列表中从索引 **n** 开始到结束位置的所有参数列表，否则只能为字符串 **#**，这样 select 返回变长参数的总数。



### 1.7 运算符

1. 算数运算符

   下表列出了 Lua 语言中的常用算术运算符，设定 A 的值为10，B 的值为 20：

   | 操作符 | 描述 | 实例               |
   | :----- | :--- | :----------------- |
   | +      | 加法 | A + B 输出结果 30  |
   | -      | 减法 | A - B 输出结果 -10 |
   | *      | 乘法 | A * B 输出结果 200 |
   | /      | 除法 | B / A 输出结果 2   |
   | %      | 取余 | B % A 输出结果 0   |
   | ^      | 乘幂 | A^2 输出结果 100   |
   | -      | 负号 | -A 输出结果 -10    |

2. 关系运算符

   下表列出了 Lua 语言中的常用关系运算符，设定 A 的值为10，B 的值为 20：

   | 操作符 | 描述                                                         | 实例                  |
   | :----- | :----------------------------------------------------------- | :-------------------- |
   | ==     | 等于，检测两个值是否相等，相等返回 true，否则返回 false      | (A == B) 为 false。   |
   | ~=     | 不等于，检测两个值是否相等，不相等返回 true，否则返回 false  | (A ~= B) 为 true。    |
   | >      | 大于，如果左边的值大于右边的值，返回 true，否则返回 false    | (A > B) 为 false。    |
   | <      | 小于，如果左边的值大于右边的值，返回 false，否则返回 true    | (A < B) 为 true。     |
   | >=     | 大于等于，如果左边的值大于等于右边的值，返回 true，否则返回 false | (A >= B) 返回 false。 |
   | <=     | 小于等于， 如果左边的值小于等于右边的值，返回 true，否则返回 false | (A <= B) 返回 true。  |

3. 逻辑运算符

   下表列出了 Lua 语言中的常用逻辑运算符，设定 A 的值为 true，B 的值为 false：

   | 操作符 | 描述                                                         | 实例                   |
   | :----- | :----------------------------------------------------------- | :--------------------- |
   | and    | 逻辑与操作符。 若 A 为 false，则返回 A，否则返回 B。         | (A and B) 为 false。   |
   | or     | 逻辑或操作符。 若 A 为 true，则返回 A，否则返回 B。          | (A or B) 为 true。     |
   | not    | 逻辑非操作符。与逻辑运算结果相反，如果条件为 true，逻辑非为 false。 | not(A and B) 为 true。 |

4. 其他运算符

   下表列出了 Lua 语言中的连接运算符与计算表或字符串长度的运算符：

   | 操作符 | 描述                               | 实例                                                         |
   | :----- | :--------------------------------- | :----------------------------------------------------------- |
   | ..     | 连接两个字符串                     | a..b ，其中 a 为 "Hello " ， b 为 "World", 输出结果为 "Hello World"。 |
   | #      | 一元运算符，返回字符串或表的长度。 | #"Hello" 返回 5                                              |



### 1.8 字符串

字符串或串(String)是由数字、字母、下划线组成的一串字符。

Lua 语言中字符串可以使用以下三种方式来表示：

- 单引号间的一串字符。
- 双引号间的一串字符。
- **[[** 与 **]]** 间的一串字符。

``` lua
string1 = "Lua"
print("\"字符串 1 是\"",string1)
string2 = 'runoob.com'
print("字符串 2 是",string2)

string3 = [["Lua 教程"]]
print("字符串 3 是",string3)


---------------------------
"字符串 1 是"    Lua
字符串 2 是    runoob.com
字符串 3 是    "Lua 教程"
```









































